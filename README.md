I did not write the original implementation of the code, I only edited it to suit my needs.
Unfortunatley I lost the link to the original author.